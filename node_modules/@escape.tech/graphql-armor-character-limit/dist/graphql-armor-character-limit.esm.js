import { GraphQLError } from 'graphql';

const characterLimitDefaultOptions = {
  maxLength: 15000
};

const characterLimitPlugin = options => {
  var _options$maxLength;

  const maxLength = (_options$maxLength = options === null || options === void 0 ? void 0 : options.maxLength) !== null && _options$maxLength !== void 0 ? _options$maxLength : characterLimitDefaultOptions.maxLength;
  return {
    onParse({
      parseFn,
      setParseFn
    }) {
      setParseFn((source, options) => {
        const query = typeof source === 'string' ? source : source.body;

        if (query && query.length > maxLength) {
          throw new GraphQLError(`Query is too large.`);
        }

        return parseFn(source, options);
      });
    }

  };
};

export { characterLimitDefaultOptions, characterLimitPlugin };
