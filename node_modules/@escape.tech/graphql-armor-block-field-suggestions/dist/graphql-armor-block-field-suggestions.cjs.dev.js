'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var graphql = require('graphql');

const blockFieldSuggestionsDefaultOptions = {
  mask: '[Suggestion message hidden by GraphQLArmor]'
};

const formatter = (error, mask) => {
  if (error instanceof graphql.GraphQLError) {
    error.message = error.message.replace(/Did you mean ".+"/g, mask);
  }

  return error;
};

const blockFieldSuggestionsPlugin = options => {
  const mask = (options === null || options === void 0 ? void 0 : options.mask) ?? blockFieldSuggestionsDefaultOptions.mask;
  return {
    onValidate: () => {
      return function onValidateEnd({
        valid,
        result,
        setResult
      }) {
        if (!valid) {
          setResult(result.map(error => formatter(error, mask)));
        }
      };
    }
  };
};

exports.blockFieldSuggestionsDefaultOptions = blockFieldSuggestionsDefaultOptions;
exports.blockFieldSuggestionsPlugin = blockFieldSuggestionsPlugin;
